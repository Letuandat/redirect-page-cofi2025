<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đang chuyển hướng...</title>
    <script>
        function redirect() {
            var url = "https://script.google.com/macros/s/AKfycbwB9KqraSD5pSBh9E6KbPCilrrd_8Hey7hlMAfdAKUUtXtun1xhr7XaWbs5eA-Gzgd81g/exec";

            // Kiểm tra nếu mở trong WebView của Facebook, Instagram, TikTok
            var userAgent = navigator.userAgent || navigator.vendor || window.opera;
            var isFacebookApp = /FBAN|FBAV/i.test(userAgent);
            var isInstagramApp = /Instagram/i.test(userAgent);
            var isTikTokApp = /Musical.ly|TikTok/i.test(userAgent);

            if (isFacebookApp || isInstagramApp || isTikTokApp) {
                // ⚡ Cách 1: Mở tab mới để ép rời khỏi WebView
                var newWindow = window.open(url, "_blank");

                if (!newWindow || newWindow.closed || typeof newWindow.closed === "undefined") {
                    // Nếu trình duyệt chặn mở tab mới, fallback dùng Facebook l.php
                    window.location.href = "https://www.facebook.com/l.php?u=" + encodeURIComponent(url);
                } else {
                    // Nếu tab mới mở được, đóng WebView cũ sau 1 giây
                    setTimeout(() => {
                        window.location.href = "about:blank";
                    }, 1000);
                }
            } else if (/android/i.test(navigator.userAgent)) {
                // ⚡ Cách 2: Nếu là Android, ép mở Chrome hoặc trình duyệt mặc định
                setTimeout(() => {
                    window.location.href = "intent://" + url.replace(/^https?:\/\//, '') + "#Intent;scheme=https;package=com.android.chrome;end;";
                }, 500);
            } else if (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {
                // ⚡ Cách 3: Nếu là iOS, dùng Safari Deep Linking
                setTimeout(() => {
                    window.location.href = "googlechrome://" + url.replace(/^https?:\/\//, '');
                }, 500);
                setTimeout(() => {
                    window.location.href = url; // Dự phòng nếu Chrome không mở
                }, 1000);
            } else {
                // ⚡ Cách 4: Nếu là trình duyệt thông thường, chuyển hướng ngay
                window.location.href = url;
            }
        }

        window.onload = redirect;
    </script>
</head>
<body>
    <p>Đang chuyển hướng 123... Nếu không tự động chuyển, <a href="https://script.google.com/macros/s/AKfycbwB9KqraSD5pSBh9E6KbPCilrrd_8Hey7hlMAfdAKUUtXtun1xhr7XaWbs5eA-Gzgd81g/exec" target="_blank">nhấn vào đây</a>.</p>
</body>
</html>
